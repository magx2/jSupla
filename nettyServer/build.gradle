repositories {
    maven { url 'http://repo.spring.io/milestone' }
    mavenCentral()
}

dependencies {
    compile rootProject.project("server")
    compile group: 'io.netty', name: 'netty-all', version: '4.1.16.Final'
    compile group: 'io.projectreactor.ipc', name: 'reactor-netty', version: '0.7.0.RELEASE'
    compile 'org.javatuples:javatuples:1.2'

    testCompile("io.projectreactor:reactor-test:$reactorVersion")
    testCompile rootProject.project("protocol").sourceSets.test.output
    testCompile rootProject.project("protocolJava").sourceSets.test.output
}

if(OPEN_HAB_HOME) {
	println "Enabling building fat jar for OpenHAb ($OPEN_HAB_HOME)"
	task fatJar(type: Jar) {
		baseName = "${project.name}-fat"
		from { configurations.compile.collect { it.isDirectory() ? it : zipTree(it) } }
		with jar
	}
	task openHab(type: Copy) {
		from fatJar.archivePath.absolutePath
		into "$OPEN_HAB_HOME\\addons\\binding\\org.openhab.binding.jsupla\\lib"
	}
	openHab.dependsOn fatJar
	fatJar.dependsOn build
	configure(openHab) {
		group = BasePlugin.BUILD_GROUP
	}
	configure(fatJar) {
		group = BasePlugin.BUILD_GROUP
	}
}
